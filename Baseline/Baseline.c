#include<stdio.h>
#include<stdlib.h>
#include<stdint.h>
#include<math.h>

#define height 32
#define width 32
#define kernel_height 3
#define kernel_width 3


uint8_t image[32][32] = {
    {131, 143, 178, 176, 161, 149, 145, 151, 161, 166, 162, 153, 146, 143, 140, 140, 142, 144, 147, 152, 159, 159, 156, 151, 144, 137, 123, 119, 129, 155, 182, 196},
    {131, 161, 188, 164, 153, 145, 137, 140, 153, 160, 160, 155, 147, 142, 138, 134, 136, 143, 141, 147, 159, 156, 153, 149, 141, 133, 125, 115, 118, 143, 174, 187},
    {140, 182, 175, 155, 152, 142, 128, 130, 147, 154, 156, 154, 149, 144, 135, 129, 128, 98, 70, 80, 103, 152, 151, 147, 139, 129, 118, 107, 108, 131, 163, 192},
    {166, 185, 161, 154, 153, 144, 129, 128, 138, 147, 153, 153, 154, 145, 129, 140, 160, 35, 28, 48, 40, 104, 153, 145, 138, 125, 109, 103, 116, 132, 181, 218},
    {184, 168, 157, 155, 159, 152, 141, 135, 133, 143, 151, 153, 159, 146, 137, 185, 198, 91, 33, 63, 75, 54, 144, 145, 134, 121, 113, 111, 124, 146, 180, 183},
    {172, 153, 155, 158, 163, 162, 155, 146, 139, 144, 151, 160, 163, 148, 132, 134, 84, 46, 43, 68, 63, 29, 127, 139, 131, 121, 108, 103, 117, 189, 205, 172},
    {155, 155, 157, 159, 167, 172, 166, 155, 147, 146, 151, 164, 166, 146, 137, 142, 90, 12, 24, 44, 38, 18, 108, 138, 130, 113, 87, 84, 118, 183, 189, 143},
    {154, 157, 160, 160, 167, 175, 173, 161, 151, 148, 151, 167, 163, 148, 148, 120, 30, 18, 16, 32, 104, 138, 135, 133, 122, 98, 84, 87, 148, 202, 156, 119},
    {152, 153, 158, 161, 165, 172, 171, 160, 151, 147, 149, 165, 162, 156, 148, 61, 78, 86, 45, 42, 107, 177, 173, 125, 114, 94, 95, 107, 188, 198, 129, 119},
    {148, 150, 155, 158, 160, 163, 163, 159, 153, 145, 141, 161, 163, 164, 96, 56, 110, 140, 146, 126, 79, 138, 167, 131, 115, 102, 103, 177, 220, 160, 112, 118},
    {145, 145, 152, 156, 156, 158, 160, 160, 156, 143, 137, 159, 162, 151, 31, 44, 156, 160, 159, 167, 156, 152, 157, 140, 124, 106, 139, 219, 191, 129, 128, 115},
    {140, 142, 149, 153, 155, 157, 162, 164, 155, 141, 143, 158, 166, 105, 84, 142, 157, 158, 153, 156, 152, 138, 153, 145, 128, 109, 168, 215, 155, 125, 132, 116},
    {135, 139, 145, 150, 150, 157, 165, 164, 152, 144, 150, 157, 164, 56, 34, 48, 119, 145, 144, 143, 142, 133, 147, 142, 130, 134, 211, 190, 123, 132, 131, 115},
    {134, 138, 141, 147, 150, 159, 166, 163, 150, 148, 153, 160, 161, 125, 89, 53, 122, 141, 138, 134, 126, 126, 141, 141, 131, 178, 214, 143, 115, 129, 125, 110},
    {136, 137, 139, 148, 157, 166, 168, 160, 153, 156, 159, 155, 74, 83, 74, 107, 143, 141, 135, 124, 114, 129, 143, 140, 166, 211, 181, 109, 111, 119, 116, 102},
    {144, 137, 136, 150, 161, 170, 171, 163, 157, 165, 162, 149, 58, 24, 97, 166, 144, 131, 126, 118, 124, 139, 133, 165, 201, 207, 138, 101, 107, 113, 115, 101},
    {151, 139, 140, 151, 162, 173, 179, 168, 152, 153, 151, 89, 49, 94, 161, 155, 141, 127, 122, 120, 118, 119, 110, 139, 191, 150, 117, 103, 102, 114, 120, 104},
    {155, 147, 147, 156, 172, 180, 180, 163, 137, 128, 119, 73, 63, 134, 145, 140, 131, 121, 117, 109, 89, 62, 108, 153, 163, 90, 107, 103, 102, 118, 121, 106},
    {163, 155, 150, 161, 173, 176, 168, 147, 124, 115, 75, 74, 118, 125, 128, 124, 119, 114, 111, 109, 126, 118, 156, 181, 130, 117, 115, 101, 104, 122, 120, 108},
    {165, 158, 149, 159, 173, 173, 154, 130, 118, 115, 107, 127, 115, 97, 106, 105, 107, 110, 117, 131, 126, 135, 186, 141, 129, 134, 116, 104, 110, 125, 119, 106},
    {163, 159, 150, 160, 178, 174, 150, 124, 114, 116, 120, 126, 104, 90, 94, 91, 111, 126, 136, 134, 133, 179, 157, 128, 148, 133, 117, 107, 113, 122, 113, 101},
    {162, 158, 153, 169, 178, 162, 137, 122, 113, 112, 109, 111, 86, 112, 123, 95, 132, 139, 140, 127, 160, 172, 121, 146, 145, 130, 115, 107, 109, 116, 107, 97},
    {169, 160, 157, 168, 161, 137, 126, 116, 112, 114, 69, 69, 104, 133, 129, 116, 131, 139, 139, 158, 187, 129, 135, 148, 141, 127, 114, 106, 104, 109, 104, 97},
    {172, 164, 164, 159, 135, 120, 119, 113, 117, 102, 50, 92, 136, 132, 131, 132, 145, 131, 120, 191, 155, 119, 145, 143, 139, 126, 115, 110, 103, 101, 101, 104},
    {175, 175, 166, 145, 117, 118, 121, 116, 120, 100, 84, 132, 135, 132, 132, 135, 135, 119, 164, 179, 123, 140, 148, 144, 140, 132, 124, 115, 101, 97, 102, 112},
    {174, 178, 162, 129, 121, 124, 126, 121, 122, 117, 120, 134, 133, 134, 133, 132, 143, 123, 147, 133, 133, 155, 152, 148, 144, 137, 131, 115, 99, 100, 111, 118},
    {166, 169, 144, 127, 132, 130, 130, 123, 131, 123, 138, 129, 133, 133, 131, 153, 195, 159, 87, 109, 156, 157, 153, 150, 146, 140, 131, 114, 100, 103, 113, 122},
    {151, 150, 136, 133, 140, 131, 128, 129, 135, 131, 133, 130, 133, 129, 139, 171, 184, 147, 91, 146, 156, 157, 155, 148, 143, 139, 124, 109, 100, 103, 116, 124},
    {140, 143, 142, 143, 142, 129, 123, 134, 128, 130, 124, 131, 134, 137, 179, 141, 72, 116, 141, 158, 157, 157, 155, 143, 138, 130, 109, 102, 101, 111, 125, 129},
    {140, 145, 151, 149, 139, 122, 115, 130, 128, 124, 123, 129, 134, 184, 180, 132, 113, 113, 155, 159, 162, 160, 150, 139, 130, 120, 110, 108, 110, 123, 133, 134},
    {141, 149, 158, 149, 130, 112, 108, 114, 120, 121, 122, 126, 170, 195, 157, 118, 106, 143, 154, 161, 163, 159, 146, 133, 120, 112, 113, 115, 120, 133, 136, 135},
    {138, 147, 154, 142, 122, 104, 101, 109, 117, 120, 124, 147, 190, 168, 123, 85, 139, 148, 154, 160, 160, 153, 143, 134, 120, 114, 118, 121, 130, 140, 137, 135}
};


const int8_t kernel[3][3] = { 
    {0,-1,0},
    {-1,5,-1},
    {0,-1,0}
};
int32_t output [height-2][width-2];


static void Conv2d(){


    // Compute the convolution
    for(int y = 0; y < height-2; y++){
        for(int x = 0; x < width-2; x++){

            int32_t sum = 0;
            for(int ky = 0; ky < kernel_height; ky++){
                for(int kx = 0; kx < kernel_width; kx++){
                    sum += kernel[ky][kx] * image[y+ky][x+kx]; 

                }
            }
            output[y][x] = sum;
        }
    }

    return;
}



int main(){



    Conv2d();



    return 0;
}
